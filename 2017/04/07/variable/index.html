<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base target="_blank" />
  
  <meta name="description" content="JavaScript 变量分为两种：基本类型和引用类型。6 种数据类型里，除了对象是引用类型变量，其他的都是基本类型变量。引用类型的变量由多个值构成。当然了，每种基本类型（null 和 undefined 除外）都有与其对应的引用类型，在必要时候，基本类型变量也会自动转换成对应引用类型变量，然后再继续运算。" />
  

  
  
  
  
  
  
  <title>JavaScript 变量 | 南潮的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="JavaScript 变量分为两种：基本类型和引用类型。6 种数据类型里，除了对象是引用类型变量，其他的都是基本类型变量。引用类型的变量由多个值构成。当然了，每种基本类型（null 和 undefined 除外）都有与其对应的引用类型，在必要时候，基本类型变量也会自动转换成对应引用类型变量，然后再继续运算。">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript 变量">
<meta property="og:url" content="http://nanchao.win/2017/04/07/variable/index.html">
<meta property="og:site_name" content="Enjoy javascript">
<meta property="og:description" content="JavaScript 变量分为两种：基本类型和引用类型。6 种数据类型里，除了对象是引用类型变量，其他的都是基本类型变量。引用类型的变量由多个值构成。当然了，每种基本类型（null 和 undefined 除外）都有与其对应的引用类型，在必要时候，基本类型变量也会自动转换成对应引用类型变量，然后再继续运算。">
<meta property="og:image" content="http://nanchao.win/css/images/variable/basic-type.png">
<meta property="og:image" content="http://nanchao.win/css/images/variable/reference-type.png">
<meta property="og:updated_time" content="2017-05-15T08:33:08.355Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JavaScript 变量">
<meta name="twitter:description" content="JavaScript 变量分为两种：基本类型和引用类型。6 种数据类型里，除了对象是引用类型变量，其他的都是基本类型变量。引用类型的变量由多个值构成。当然了，每种基本类型（null 和 undefined 除外）都有与其对应的引用类型，在必要时候，基本类型变量也会自动转换成对应引用类型变量，然后再继续运算。">
<meta name="twitter:image" content="http://nanchao.win/css/images/variable/basic-type.png">
  
  
    <link rel="icon" href="/css/images/favicon.ico">
  
  <link rel="stylesheet" href="/css/style.css">
  

    
  <script src="/js/jquery-2.0.3.min.js"></script>

  <script src='/js/nprogress.js'></script>
  <link rel='stylesheet' href='/css/nprogress.css'/>

  <link rel="stylesheet" href="/css/prettify.css" type="text/css">
  <script src="/js/prettify.js" type="text/javascript"></script>

  <!-- baidu webmaster push -->
  <!--<script src='//push.zhanzhang.baidu.com/push.js'></script>-->
    
</head>
<body class="home blog custom-background custom-font-enabled single-author">
  <div id="page" class="hfeed site">
      

<header id="masthead" class="site-header" role="banner">
    <hgroup>
      <h1 class="site-title">
        <a href="/" title="Enjoy javascript" rel="home">Enjoy javascript</a>
      </h1>
      
        <h2 class="site-description">
          <a href="/" id="subtitle">为者常成，行者常至</a>
        </h2>
      
    </hgroup>

    <nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle">菜单</button>
            <a class="assistive-text" href="/#content" title="跳至内容">跳至内容</a><!--TODO-->
            <div class="menu-main-container">
                <ul id="menu-main" class="nav-menu">
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/">Home</a></li>
                
                    <li class="menu-item menu-item-type-post_type menu-item-object-page"><a href="/demo">Demo</a></li>
                
                </ul>
            </div>
    </nav>
</header>



<script>
    // Show the progress bar 
    NProgress.start();

    // Increase randomly
    var interval = setInterval(function() { NProgress.inc(); }, 1000);        

    // Trigger finish when page fully loaded
    jQuery(window).load(function () {
        clearInterval(interval);
        NProgress.done();
    });

    // Trigger bar when exiting the page
    jQuery(window).unload(function () {
        NProgress.start();
    });

</script>
      <div id="main" class="wrapper">
        <div id="primary" class="site-content"><div id="content" role="main"><article id="post-variable" class="post-variable post type-post status-publish format-standard hentry">
    <!---->

      <header class="entry-header">
        
        
  
    <h1 class="entry-title article-title">
      JavaScript 变量
    </h1>
  

        
        <div class="comments-link">
            
            <a href="/2017/04/07/variable/#comments" class="leave-reply">Reply</a>
            
            <a href="javascript:void(0);" data-url="http://nanchao.win/2017/04/07/variable/" data-id="cj36o13fb002iggbad9ia0xfb" class="leave-reply bdsharebuttonbox" data-cmd="more">Share</a>
        </div><!-- .comments-link -->
      </header><!-- .entry-header -->

    

    <div class="entry-content">
      
        <p>JavaScript 变量分为两种：基本类型和引用类型。6 种数据类型里，除了对象是引用类型变量，其他的都是基本类型变量。引用类型的变量由多个值构成。当然了，每种基本类型（null 和 undefined 除外）都有与其对应的引用类型，在必要时候，基本类型变量也会自动转换成对应引用类型变量，然后再继续运算。</p>
<a id="more"></a>
<p><strong>基本类型数据不能为之添加属性，引用类型则可以。</strong></p>
<pre><code>// 基本类型属性不能添加属性，即便添加了也无效
var site = &#39;Enjoy JavaScript&#39;;
console.log(site.author);
// undefined

site.author = &#39;nanc&#39;;
console.log(site.author);
// undefined

// 引用类型变量可以添加属性
// 引用类型数据包括 function、array、object
var f = function(){}
console.log(f.author);
// undefined

f.author = &#39;nanc&#39;;
console.log(f.author);
// nanc
</code></pre><p>如果非要给原始类型变量添加属性也是可以的，只不过不是直接给某个变量添加，而是给其构造函数的 prototype 对象添加。由于这样做会影响到同类的其他变量，所以，慎之。</p>
<pre><code>var site = &#39;Enjoy JavaScript&#39;;
console.log(site.author);
// undefined

String.prototype.author = &#39;nanc&#39;;
console.log(site.author);
// nanc
</code></pre><p>理解基本类型变量和引用类型变量区别，关键是要理解它们的在内存中存储方式的不同。</p>
<p><strong>JavaScript 变量的存储包含三部分：</strong></p>
<blockquote>
<p>部分一：栈区变量的标识符<br>部分二：栈区变量的值<br>部分三：堆区存储的对象</p>
</blockquote>
<p>我们定义变量如下：</p>
<pre><code>// 基本类型：
var str = &quot;Enjoy javascript&quot;;
var num = 666;
var isOpen = true;

// 引用变量：
var obj1 = {};
var obj2 = obj1;
var obj3 = {};
</code></pre><p><strong>基本类型变量只存放在内存的栈区（栈内存）：</strong></p>
<p><img src="/css/images/variable/basic-type.png" alt="作用域链"></p>
<p><strong>引用类型变量由栈区和堆区（堆内存）配合存放：</strong></p>
<p><img src="/css/images/variable/reference-type.png" alt="作用域链"></p>
<p>一般情况下，基本类型变量只有部分一和部分二；引用类型变量有三个部分，其中，部分二中“栈区变量的值”是部分三种对象堆内存的地址。</p>
<p>这里也可以解释为什么 null 比 undefined 更耗内存的问题：<br>当变量的值为 undefined 时候，它是基本类型变量，并且该变量只有栈区的标示符，如果我们对这个变量进行赋值操作，那么栈区的值就有值了；如果栈区是对象标识符那么堆区会有一个对象，而栈区的值则是堆区对象的地址，对于 null ，JavaScript 认为它是一个对象，虽然它的堆区是个空对象，但是栈区的标示符和值都会有值，堆区也有，这么说来 null 确实比 undefined 更耗内存了。</p>
<p><strong>JavaScript 变量复制</strong></p>
<p>（1）基本类型变量</p>
<pre><code>var str1 = &quot;Enjoy javascript&quot;;
var str2 = str1;

console.log(str1);
// &quot;Enjoy javascript&quot;;
console.log(str2);
// &quot;Enjoy javascript&quot;;

// 修改 str2 的值，str1 不会跟着改变
str2 = &quot;Enjoy css&quot;;

console.log(str1);
// &quot;Enjoy javascript&quot;;
console.log(str2);
// &quot;Enjoy css&quot;
</code></pre><p>（2）引用类型变量</p>
<pre><code>var obj1 = {};
obj1.name = &#39;zx&#39;;
var obj2 = obj1;

console.log(obj1.name);
// zx
console.log(obj2.name);
// zx

// 修改 obj2.name 的值，obj1.name 会跟着改变
obj2.name = &#39;zc&#39;;

console.log(obj1.name);
// zc
console.log(obj2.name);
// zc
</code></pre><p>以上对变量复制的过程，引用类型变量的“原变量”和“新变量”会“绑定在一起”，它们其中一个的属性变化，另一个也会跟着变化，这叫变量复制也叫做浅拷贝；基本类型变量的“原变量”和“新变量”是独立的，一个变化不会影响另一个，这种变量复制也叫做深拷贝。</p>
<p>为什么会这样呢？</p>
<p>我们再回顾一下上文 JavaScript 变量的存储方式。基本类型变量只有栈区的变量标识符和栈区的变量值，而引用类型变量有栈区的变量标识符、栈区的变量值（堆区的地址）以及堆区的对象数据。<strong>变量复制的本质是传值，这个值就是栈区的变量值。</strong>基本类型变量的的值就是存放在栈区里的值，复制后，两个变量互不影响；复制引用类型变量的时候，复制的也是栈区的变量值，而这个值是对象数据在堆区的地址，堆内存的对象数据并没有复制，然后两个标识符指向同一个堆内存，当我们对其中一个变量修改（修改堆内存数据），另一个变量当然也会跟着改变。</p>
<p>引用类型变量（函数、数组、对象）直接复制都是浅拷贝，下面，我们举例说明如何实现其深拷贝。</p>
<p>① 数组深拷贝：</p>
<pre><code>//slice 方法或 concat 方法
var arr1 = [0,1,2];
var arr2 = arr1.slice(0);
// 这句相当于 var arr2 = arr1.concat();

arr2[0] = 100;

console.log(arr1);
// [0,1,2]
console.log(arr2);
// [100,1,2]
</code></pre><p>② 对象深拷贝：</p>
<pre><code>function deepCopy(parent,child){
    var i,
        toStr = Object.prototype.toString,
        astr = &quot;[object Array]&quot;;

    child = child || {};

    for (i in parent){
        if (parent.hasOwnProperty(i)){
            if (typeof parent[i] === &quot;object&quot;){
                if (toStr.call(parent[i]) === astr){
                    child[i] = [];
                } else {
                    child[i] = {};
                }
                deepCopy(parent[i],child[i]);
            } else {
                child[i] = parent[i];
            }
        }
    }

    return child;
}

// eg:
var dad = {
    counts : [1,2,3],
    reads : {paper : true}
};

var kid = deepCopy(dad);
kid.counts.push(4);

kid.counts.toString();
// &#39;1,2,3,4&#39;
dad.counts.toString();
// &#39;1,2,3&#39;

// 因为 typeof 运算符对 null 运算返回也是 &quot;object&quot;
typeof null   // &quot;object&quot;

// 所以，当父对象包含属性 null 时会有偏差

var o1 = {prop : null};
var o2 = deepCopy(o1);

o1.prop  // null
o2.prop  // Object {}
</code></pre><p><strong>JavaScript 函数传参</strong></p>
<p>看一个简单例子：</p>
<pre><code>function f(str,obj){
    str = &#39;changed string&#39;;
    obj.name = &#39;changed object&#39;;
}

var s = &#39;Enjoy javascript&#39;;
var o = {name : &#39;new object&#39;};

f(s,o);

console.log(s);
// Enjoy javascript

console.log(o.name);
// changed object
</code></pre><p>基本类型值经过函数调用后不会改变原值，而引用类型变量却被改变了。不要觉得奇怪，因为 <strong>JavaScript 中函数传递参数的本质也是变量复制，外部变量的值复制给函数参数。</strong></p>
<p>再看一个例子：</p>
<pre><code>function changeFunc(f){
    f = f2;
}

function f1(){
    console.log(&quot;I&#39;m f1 function&quot;);
}

function f2(){
    console.log(&quot;I&#39;m f2 function&quot;);
}

changeFunc(f1);

f1();
// I&#39;m f1 function
</code></pre><p>对于以上执行结果有没有感到意外呢？不必感到意外，就是这样的。函数 changeFunc 执行的时候，先将参数变量 f 指向函数 f1，然后让参数变量 f 指向函数 f2，切断了 f 和 f1 的联系，所以 f1 还是原来的 f1，不会因为 f 的参与，让它变成 f2。</p>
<p><strong>总之，记住一句话：javascript 里变量复制和函数传参都是在传递栈区的值，“严格相等运算符” === 比较的也是栈区的值。</strong></p>
<p>最后，看一种不声明第三个变量情况下交换俩变量值的方法：</p>
<pre><code>var a = 1,b = 2;
a = [b,b=a][0];
a // 2
b // 1
</code></pre><p>参考：<br>[1] <a href="http://www.cnblogs.com/sharpxiajun/p/4133462.html" target="_blank" rel="external">http://www.cnblogs.com/sharpxiajun/p/4133462.html</a><br>[2] <a href="http://www.cnblogs.com/yichengbo/archive/2014/07/10/3835882.html" target="_blank" rel="external">http://www.cnblogs.com/yichengbo/archive/2014/07/10/3835882.html</a></p>

      
    </div><!-- .entry-content -->


    <footer class="entry-meta">
    <a href="/2017/04/07/variable/">
    <time datetime="2017-04-07T08:17:17.000Z" class="entry-date">
        2017-04-07
    </time>
</a>
    
    
  <span class="article-delim">&#8226;</span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/">js</a></li></ul>

    </footer>
</article>




    <p>
    <span id="busuanzi_container_page_pv">
      <span id="busuanzi_value_page_pv"></span> views
    </span>
</p>
</br>

<nav class="nav-single">
    <h3 class="assistive-text">文章导航</h3>
    
        <p><span class="nav-previous"><a href="/2017/04/14/some-javascript-functions/" rel="prev"><span class="meta-nav">上一篇：</span>几个典型的 JavaScript 函数</a></span></p>
    
    
        <p><span class="nav-next"><a href="/2017/04/07/data-type/" rel="next"><span class="meta-nav">下一篇：</span>JavaScript 数据类型 </a></span></p>
    
</nav><!-- .nav-single -->






<section id="comments">
  <!--网易云跟帖 开始-->
  <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
  <script>
  var cloudTieConfig = {
    url: document.location.href, 
    sourceId: "",
    productKey: "5a032688db1348678f3949687092d2c3",
    target: "cloud-tie-wrapper"
  };
  </script>
  <script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>
  <!--网易云跟帖 结束-->
</section>



</div></div>
        <div id="secondary" class="widget-area" role="complementary">
  
    
  
    
  
    
  <aside class="widget">
    <h3 class="widget-title">Recents</h3>
    <div class="widget-content">
      <ul>
        
          <li>
            <a href="/2017/05/24/cross-origin/">跨域解决方案</a>
          </li>
        
          <li>
            <a href="/2017/05/12/observer/">JavaScript 观察者模式</a>
          </li>
        
          <li>
            <a href="/2017/05/04/singleton/">JavaScript 单例模式</a>
          </li>
        
          <li>
            <a href="/2017/05/02/ready/">ready 方法的实现</a>
          </li>
        
          <li>
            <a href="/2017/04/21/call-apply-bind/">理解 call + bind</a>
          </li>
        
          <li>
            <a href="/2017/04/14/some-javascript-functions/">几个典型的 JavaScript 函数</a>
          </li>
        
          <li>
            <a href="/2017/04/07/variable/">JavaScript 变量</a>
          </li>
        
          <li>
            <a href="/2017/04/07/data-type/">JavaScript 数据类型</a>
          </li>
        
          <li>
            <a href="/2017/04/06/CSRF/">CSRF 攻击原理</a>
          </li>
        
          <li>
            <a href="/2017/04/05/XSS/">XSS 攻击原理</a>
          </li>
        
      </ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tags</h3>
    <div class="widget-content">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/">algorithm</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/grammar/">grammar</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/">js</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/method/">method</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/problem/">problem</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a><span class="tag-list-count">2</span></li></ul>
    </div>
  </aside>

  
    
  <aside class="widget">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget-content tagcloud">
      <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/grammar/" style="font-size: 12.5px;">grammar</a> <a href="/tags/js/" style="font-size: 17.5px;">js</a> <a href="/tags/method/" style="font-size: 20px;">method</a> <a href="/tags/problem/" style="font-size: 15px;">problem</a> <a href="/tags/tools/" style="font-size: 10px;">tools</a>
    </div>
  </aside>

  
    
  
</div>
      </div>
      <footer id="colophon" role="contentinfo">
    <p>&copy; 2017 <a href="https://github.com/jserNc/" target="_blank">nanc</a>
    All rights reserved. Powered by 
        <a href="http://hexo.io/" target="_blank">Hexo</a>
    </p>
    <p>
        <span id="busuanzi_container_site_uv">
            你是本站第<span id="busuanzi_value_site_uv"></span>位访客，欢迎你！
        </span>
    </p>
</footer>
    

<script>
$(window).load(function(){
 $('pre').addClass('prettyprint linenums').attr('style', 'overflow:auto;');
   prettyPrint();
 })
</script>

<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>


<script src="/js/jquery.goup.min.js"></script>
<script>
$(document).ready(function () {  
    $.goup({  
        trigger: 100,  
        bottomOffset: 62,       //距底部偏移量   
        locationOffset: 150,     //距右部偏移量  
        title: '返回顶部',  
        titleAsText: true       //是否显示title  
    });  
}); 
</script>


<!--<script src="/js/navigation.js"></script>-->

<div id="bg"></div>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>





  </div>
</body>
</html>